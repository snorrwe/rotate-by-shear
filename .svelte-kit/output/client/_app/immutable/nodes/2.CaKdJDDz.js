var le=Object.defineProperty;var z=e=>{throw TypeError(e)};var Te=(e,r,a)=>r in e?le(e,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[r]=a;var K=(e,r,a)=>Te(e,typeof r!="symbol"?r+"":r,a),N=(e,r,a)=>r.has(e)||z("Cannot "+a);var h=(e,r,a)=>(N(e,r,"read from private field"),a?a.call(e):r.get(e)),X=(e,r,a)=>r.has(e)?z("Cannot add the same private member more than once"):r instanceof WeakSet?r.add(e):r.set(e,a),C=(e,r,a,o)=>(N(e,r,"write to private field"),o?o.call(e,a):r.set(e,a),a),J=(e,r,a)=>(N(e,r,"access private method"),a);import{a as ne,t as se}from"../chunks/disclose-version.CI0S6WHf.js";import{C as Q,D as Z,F as Ee,h as me,w as H,ar as Re,as as xe,j as pe,at as Ae,au as be,a as ie,r as Fe,m as Ue,y as ue,u as B,a3 as ce,A as fe,f,e as k,aq as $,a1 as y,a4 as b,a6 as m,a5 as F}from"../chunks/runtime.DHxwUyU3.js";import{s as O}from"../chunks/render.DywDSvmS.js";import{p as we,b as Se}from"../chunks/this.m5CV3xlH.js";let ee=!1;function _e(){ee||(ee=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{var r;if(!e.defaultPrevented)for(const a of e.target.elements)(r=a.__on_r)==null||r.call(a)})},{capture:!0}))}function Xe(e){var r=Ee,a=me;Q(null),Z(null);try{return e()}finally{Q(r),Z(a)}}function De(e,r,a,o=a){e.addEventListener(r,()=>Xe(a));const n=e.__on_r;n?e.__on_r=()=>{n(),o(!0)}:e.__on_r=()=>o(!0),_e()}function re(e){if(H){var r=!1,a=()=>{if(!r){if(r=!0,e.hasAttribute("value")){var o=e.value;D(e,"value",null),e.value=o}if(e.hasAttribute("checked")){var n=e.checked;D(e,"checked",null),e.checked=n}}};e.__on_r=a,Re(a),_e()}}function D(e,r,a,o){var n=e.__attributes??(e.__attributes={});H&&(n[r]=e.getAttribute(r),r==="src"||r==="srcset"||r==="href"&&e.nodeName==="LINK")||n[r]!==(n[r]=a)&&(r==="style"&&"__styles"in e&&(e.__styles={}),r==="loading"&&(e[xe]=a),a==null?e.removeAttribute(r):typeof a!="string"&&Pe(e).includes(r)?e[r]=a:e.setAttribute(r,a))}var te=new Map;function Pe(e){var r=te.get(e.nodeName);if(r)return r;te.set(e.nodeName,r=[]);for(var a,o=e,n=Element.prototype;n!==o;){a=Ae(o);for(var s in a)a[s].set&&r.push(s);o=pe(o)}return r}function ae(e,r,a=r){var o=be();De(e,"input",n=>{var s=n?e.defaultValue:e.value;if(s=G(e)?W(s):s,a(s),o&&s!==(s=r())){var v=e.selectionStart,d=e.selectionEnd;e.value=s??"",d!==null&&(e.selectionStart=v,e.selectionEnd=Math.min(d,e.value.length))}}),(H&&e.defaultValue!==e.value||ie(r)==null&&e.value)&&a(G(e)?W(e.value):e.value),Fe(()=>{var n=r();G(e)&&n===W(e.value)||e.type==="date"&&!n&&!e.value||n!==e.value&&(e.value=n??"")})}function G(e){var r=e.type;return r==="number"||r==="range"}function W(e){return e===""?null:+e}var l,U,P,g,ve;const L=class L{constructor(r){X(this,g);X(this,l,new WeakMap);X(this,U);X(this,P);C(this,P,r)}observe(r,a){var o=h(this,l).get(r)||new Set;return o.add(a),h(this,l).set(r,o),J(this,g,ve).call(this).observe(r,h(this,P)),()=>{var n=h(this,l).get(r);n.delete(a),n.size===0&&(h(this,l).delete(r),h(this,U).unobserve(r))}}};l=new WeakMap,U=new WeakMap,P=new WeakMap,g=new WeakSet,ve=function(){return h(this,U)??C(this,U,new ResizeObserver(r=>{for(var a of r){L.entries.set(a.target,a);for(var o of h(this,l).get(a.target)||[])o(a)}}))},K(L,"entries",new WeakMap);let Y=L;var ye=new Y({box:"border-box"});function Me(e,r,a){var o=ye.observe(e,()=>a(e[r]));Ue(()=>(ie(()=>a(e[r])),o))}function de(e){return Math.tan(e/2)}function he(e){return Math.sin(e)}const ge=`#version 300 es

precision highp float;

out vec2 uv;
uniform mat2 u_tform;
uniform float u_flip;

void main() {
  vec2 v = vec2(float((gl_VertexID << 1) & 2), float(gl_VertexID & 2));

  uv = (v - vec2(0.5)) * u_tform + vec2(0.5);
  uv.y *= u_flip;
  gl_Position = vec4(v * vec2(2, -2) + vec2(-1, 1), 0.0, 1.0);
}
`,Le=`#version 300 es

precision highp float;

out vec4 outColor;
in vec2 uv;

uniform sampler2D u_texture;

void main() { outColor = texture(u_texture, uv); }
`;function oe({gl:e,type:r,source:a}){const o=e.createShader(r);return o==null?(console.error("Failed to create the shader"),null):(e.shaderSource(o,a),e.compileShader(o),e.getShaderParameter(o,e.COMPILE_STATUS)?o:(console.error("Failed to compile shader",e.getShaderInfoLog(o)),e.deleteShader(o),null))}function Ie({gl:e}){const r=oe({gl:e,type:e.VERTEX_SHADER,source:ge});if(console.assert(r!=null),!r)return null;const a=oe({gl:e,type:e.FRAGMENT_SHADER,source:Le});if(console.assert(a!=null),!a)return null;const o=e.createProgram();if(e.attachShader(o,r),e.attachShader(o,a),e.linkProgram(o),e.getProgramParameter(o,e.LINK_STATUS)){const n=e.getUniformLocation(o,"u_texture"),s=e.getUniformLocation(o,"u_tform"),v=e.getUniformLocation(o,"u_flip");return{program:o,textureLocation:n,transformLocation:s,flipLocation:v}}return console.error("Failed to link shader program",e.getProgramInfoLog(o)),e.deleteProgram(o),null}const _=we({texture:null,gl:null,program:null});function M(e){return e.REPEAT}function Ne({gl:e,url:r}){return console.debug("loading texture",r),new Promise((a,o)=>{const n=new Image;n.src=r,n.addEventListener("load",()=>{const s=e.createTexture();e.bindTexture(e.TEXTURE_2D,s),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n),e.generateMipmap(e.TEXTURE_2D),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,M(e)),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,M(e)),a(s)})})}var Ce=se("<canvas></canvas>");function Be(e,r){ue(r,!0);let a;function o(t){return new Float32Array([1,de(t),0,1])}function n(t){return new Float32Array([1,0,he(t),1])}B(()=>{const t=a.getContext("webgl2");if(console.assert(t!=null),console.assert(r.width&&r.height),_.gl=t,!t)return;let i=Ie({gl:t});console.assert(i!=null),i&&(_.program=i)}),B(()=>{_.gl&&Ne({gl:_.gl,url:r.imagePath}).then(t=>{_.texture=t})});function s(t,i,u,c=!1){t.useProgram(_.program.program),t.activeTexture(t.TEXTURE0+0),t.bindTexture(t.TEXTURE_2D,u),t.uniformMatrix2fv(_.program.transformLocation,!1,i),t.uniform1f(_.program.flipLocation,c?-1:1),t.drawArrays(t.TRIANGLES,0,3)}function v(t){const i=t.canvas.width,u=t.canvas.height,c=t.createTexture();t.bindTexture(t.TEXTURE_2D,c);const R=0,T=t.RGBA,x=0,p=t.RGBA,A=t.UNSIGNED_BYTE;return t.texImage2D(t.TEXTURE_2D,R,T,i,u,x,p,A,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,M(t)),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,M(t)),c}B(()=>{const t=_.gl;if(t&&(t.viewport(0,0,a.width,a.height),t.clearColor(0,1,1,1),t.clear(t.COLOR_BUFFER_BIT),_.texture!=null)){let i=v(t),u=v(t),c=v(t);if(!i||!u||!c){console.error("Failed to create backbuffers");return}let R=t.createFramebuffer();const T=new Float32Array([1,0,0,1]),x=o(r.angle),p=n(r.angle);t.bindFramebuffer(t.FRAMEBUFFER,R),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,i,0),s(t,x,_.texture),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,u,0),s(t,p,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,c,0),s(t,x,u),t.bindFramebuffer(t.FRAMEBUFFER,null);let A=t.canvas.width/4;[_.texture,i,u,c].forEach((w,S)=>{t.viewport(S*A,0,A,t.canvas.height),s(t,T,w,S%2==1)}),t.deleteTexture(i),t.deleteTexture(u),t.deleteTexture(c),t.deleteFramebuffer(R)}});var d=Ce();Se(d,t=>a=t,()=>a),ce(()=>{D(d,"style",`width=${r.width??""}; height=${r.height??""}`),D(d,"width",r.width),D(d,"height",r.height)}),ne(e,d),fe()}var ke=se('<div class="container svelte-ty97hw"><div class="labels svelte-ty97hw"><p>Original</p> <p> </p> <p> </p> <p> </p></div> <!> <div><label for="angle">Angle in degress</label> <input name="angle" type="number" min="-90" max="90" step="5"> <input name="angle" type="range" min="-90" max="90" step="5"></div></div>');function Ve(e,r){ue(r,!0);let a=$(0),o=y(()=>f(a)*Math.PI/180),n=$(void 0),s=y(()=>Math.floor(f(n)/4)),v=y(()=>t(de(f(a)))),d=y(()=>t(he(f(a))));function t(E,j=2){const q=Math.pow(10,j);return(Math.round(E*q)/q).toFixed(j)}var i=ke(),u=b(i),c=m(b(u),2),R=b(c);F(c);var T=m(c,2),x=b(T);F(T);var p=m(T,2),A=b(p);F(p),F(u);var w=m(u,2);Be(w,{get width(){return f(n)},get height(){return f(s)},imagePath:"rocket.jpg",get angle(){return f(o)}});var S=m(w,2),I=m(b(S),2);re(I);var V=m(I,2);re(V),F(S),F(i),ce(()=>{O(R,`Shear X by ${f(v)??""}`),O(x,`Shear Y by ${f(d)??""}`),O(A,`Shear X by ${f(v)??""}`)}),Me(u,"clientWidth",E=>k(n,E)),ae(I,()=>f(a),E=>k(a,E)),ae(V,()=>f(a),E=>k(a,E)),ne(e,i),fe()}export{Ve as component};
